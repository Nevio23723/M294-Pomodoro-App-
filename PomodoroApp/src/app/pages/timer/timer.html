<div class="timer-page">
    <header class="timer-header">
        <button class="back-btn" (click)="goBack()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
            <span>Zurück</span>
        </button>
    </header>

    <main class="timer-main">
        @if (!isCompleted()) {
        <div class="timer-display">
            <svg class="progress-ring" viewBox="0 0 300 300">
                <circle class="progress-bg" cx="150" cy="150" r="140" fill="none" stroke-width="6" />
                <circle class="progress-bar" cx="150" cy="150" r="140" fill="none" stroke-width="6"
                    [style.stroke-dashoffset]="strokeDashoffset()" transform="rotate(-90 150 150)" />
            </svg>

            <div class="time-display">
                <span class="time">{{ formatTime(minutes()) }}:{{ formatTime(seconds()) }}</span>
                <span class="label">{{ isRunning() ? 'Fokus' : 'Bereit' }}</span>
            </div>
        </div>

        <div class="controls">
            <button class="control-btn secondary" (click)="resetTimer()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 4v6h6M23 20v-6h-6" />
                    <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15" />
                </svg>
            </button>

            <button class="control-btn primary" (click)="toggleTimer()">
                @if (isRunning()) {
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <rect x="6" y="4" width="4" height="16" rx="1" />
                    <rect x="14" y="4" width="4" height="16" rx="1" />
                </svg>
                } @else {
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <polygon points="5 3 19 12 5 21 5 3" />
                </svg>
                }
            </button>

            <button class="control-btn secondary" (click)="goBack()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" />
                    <path d="M9 9l6 6M15 9l-6 6" />
                </svg>
            </button>
        </div>
        } @else {
        <div class="completion-screen">
            <div class="success-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M20 6L9 17l-5-5" />
                </svg>
            </div>
            <h2>Session beendet!</h2>
            <p class="congrats">Du hast dir eine Pause verdient.</p>

            @if (quote()) {
            <div class="quote-card">
                <p class="quote-text">"{{ quote()?.text }}"</p>
                <p class="quote-author">— {{ quote()?.author }}</p>
            </div>
            } @else {
            <div class="quote-loading">Lade Zitat...</div>
            }

            <div class="completion-actions">
                <button class="action-btn primary" (click)="startNewSession()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M1 4v6h6M23 20v-6h-6" />
                        <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15" />
                    </svg>
                    <span>Neue Session</span>
                </button>
                <button class="action-btn secondary" (click)="goBack()">
                    <span>Zum Dashboard</span>
                </button>
            </div>
        </div>
        }
    </main>
</div>